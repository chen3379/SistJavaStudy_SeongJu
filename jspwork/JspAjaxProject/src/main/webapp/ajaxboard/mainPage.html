<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link
  href="https://fonts.googleapis.com/css2?family=Dongle&family=Gamja+Flower&family=Nanum+Myeongjo&family=Nanum+Pen+Script&display=swap"
  rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
<title>title</title>
<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
<style type="text/css">
body {
  background: #f4f6f9;
  font-family: 'Nanum Pen Script', cursive;
}

div.list {
  position: absolute;
  left: 70px;
  top: 100px;
}

div.addform {
  position: absolute;
  left: 1000px;
  top: 100px;
  background: white;
  padding: 20px;
  border-radius: 15px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.15);
}

#addbtn {
  background: linear-gradient(135deg, #6f86d6, #48c6ef);
  color: white;
  border: none;
  padding: 10px 18px;
  border-radius: 20px;
  font-size: 16px;
  margin-bottom: 15px;
  cursor: pointer;
}

#addbtn:hover {
  opacity: 0.85;
}

table.li {
  width: 820px;
  background: white;
  border-radius: 15px;
  overflow: hidden;
  box-shadow: 0 5px 15px rgba(0,0,0,0.15);
}

table.li th {
  background: #e3f2fd;
  text-align: center;
}

table.li td {
  vertical-align: middle;
}

img {
  width: 30px;
}

pre {
  margin: 0;
  font-family: 'Nanum Pen Script', cursive;
  white-space: pre-wrap;
}

caption b {
  font-size: 22px;
}

textarea {
  resize: none;
}

.btn-secondary {
  background: linear-gradient(135deg, #ff758c, #ff7eb3);
  border: none;
  border-radius: 20px;
}

.btn-secondary:hover {
  opacity: 0.85;
}

</style>
<script type="text/javascript">
  $(function() {

    list();

    $(".addform").hide();

    $("#addbtn").click(function() {
      $(".addform").toggle();

    })

    $("#dbsave").click(function() {
      var data = $("#addfrm").serialize();

      $.ajax({
        type : "post",
        url : "boardInsert.jsp",
        dataType : "html",
        data : data,
        success : function(res) {
          list();
          $("#writer").val("");
          $("#subject").val("");
          $("#content").val("");

        }
      })
    })

    function list() {

      $.ajax({
        type : "get",
        url : "boardList.jsp",
        dataType : "json",
        success : function(res) {

          var s = ""
          if (res.length == 0) {
            s += "<h4 class='alert alert-success'>방문객이 없습니다</h4>";
          } else {
            s += "<table class='table table-bordered li'>";
            s += "<tr class='table-secondary'>";
            s += "<th style='width:40px;'>번호</th>";
            s += "<th style='width:200px;'>제목</th>";
            s += "<th>내용</th>";
            s += "<th style='width:70px;'>작성자</th>";
            s += "<th style='width:110px;'>작성일자</th>";
            s += "</tr>";

            $.each(res, function(i, e) {
              s += "<tr>";
              s += "<td style='text-align:center;'>" + e.num + "</td>";
              s += "<td>" + e.subject + "</td>";
              s += "<td><pre>" + e.content + e.avata + "</pre></td>";
              s += "<td style='text-align: center;'>" + e.writer + "</td>";
              s += "<td>" + e.writeday + "</td>";
              s += "</tr>"
            })
            s += "</table>";
          }
          $("div#boardList").html(s);

        }
      })

    }

  })
</script>
</head>
<body>
  <div class="list">
    <button id="addbtn">글쓰기버튼</button>
    <div id="boardList"></div>
  </div>
  <div class="ajax addform">
    <form id="addfrm">
      <table class="table table-bordered" style='width: 500px;'>
        <caption align="top">
          <b>글 작성하기</b>
        </caption>
        <tr>
          <th width="100" class="table-success" style='text-align:center;'>작성자</th>
          <td>
            <input type="text" class="form-control" name="writer" id="writer" required="required" style="width: 120px;">
          </td>
        </tr>
        <tr>
          <th width="100" class="table-success" style='text-align:center;'>제목</th>
          <td>
            <input type="text" class="form-control" name="subject" id="subject" required="required" style="width: 120px;">
          </td>
        </tr>
        <tr>
          <th width="100" class="table-success" style='text-align:center;'>이모티콘</th>
          <td>
            <select id="avata" name="avata">
              <option value="<img src='../image/avata/b1.png'>" selected="selected">사랑해</option>
              <option value="<img src='../image/avata/b2.png'>">심심</option>
              <option value="<img src='../image/avata/b3.png'>">Hi~~</option>
              <option value="<img src='../image/avata/b5.png'>">배고픔</option>
              <option value="<img src='../image/avata/b6.png'>">좌절</option>
              <option value="<img src='../image/avata/b7.png'>">신남</option>
              <option value="<img src='../image/avata/b8.png'>">최고</option>
            </select>
          </td>
        </tr>
        <tr>
          <td colspan="2">
            <textarea style="width: 400px; height: 80px;" class="form-control" name="content" id="content"></textarea>
          </td>
        </tr>
        <tr>
          <td colspan="2" align="center">
            <button type="button" class="btn btn-secondary" id="dbsave">DB에 저장하기</button>
          </td>
        </tr>
      </table>
    </form>
  </div>
</body>
</html>